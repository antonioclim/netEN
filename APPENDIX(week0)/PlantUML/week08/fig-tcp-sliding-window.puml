@startuml fig-tcp-sliding-window
'A4 Landscape
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam shadowing false

title TCP Sliding Window\nFlow control mechanism

rectangle "Sender View" as sender #E3F2FD {
    rectangle "Sent & ACKed" as sacked #C8E6C9
    rectangle "Sent, not ACKed" as ssent #FFF9C4
    rectangle "Can send (window)" as swin #BBDEFB
    rectangle "Cannot send yet" as swait #ECEFF1
}

rectangle "Receiver View" as receiver #E8F5E9 {
    rectangle "Received & ACKed" as racked #C8E6C9
    rectangle "Receive Window\n(buffer space)" as rwin #BBDEFB
    rectangle "Not yet received" as rwait #ECEFF1
}

note bottom of sender
    Window Size = min(cwnd, rwnd)
    cwnd = Congestion window (sender)
    rwnd = Receive window (receiver)
    
    Sender can have up to Window bytes
    in flight (sent but not ACKed)
end note

note bottom of receiver
    Receiver advertises available
    buffer space in Window field
    
    Window = 0: Stop sending!
    Window > 0: Can send more
end note

note as N1
    Example Sequence:
    1. Receiver: Window=4000
    2. Sender sends 4000 bytes
    3. Receiver: ACK, Window=2000
       (processed 2000, buffer filling)
    4. Sender can only send 2000 more
end note

