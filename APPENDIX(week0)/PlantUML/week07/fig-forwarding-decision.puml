@startuml fig-forwarding-decision
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam shadowing false
title Router Forwarding Decision

start
:Packet arrives;
if (Valid L3 header?) then (yes)
else (no)
    #FFCDD2:Drop;
    stop
endif
if (TTL > 1?) then (yes)
    :Decrement TTL;
else (no)
    :ICMP Time Exceeded;
    stop
endif
:Lookup routing table;
if (Route found?) then (yes)
    :Longest Prefix Match;
else (no)
    if (Default route?) then (yes)
        :Use default;
    else (no)
        :ICMP Unreachable;
        stop
    endif
endif
:ARP for next-hop MAC;
:Forward packet;
stop
@enduml
