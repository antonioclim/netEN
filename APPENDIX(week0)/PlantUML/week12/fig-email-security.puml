@startuml fig-email-security
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 10
skinparam shadowing false
title Email Authentication SPF/DKIM/DMARC

package "SPF" as spf #E3F2FD {
    card "DNS TXT: v=spf1\nip4:x.x.x.x -all\nVerifies sender IP" as spf_d
}

package "DKIM" as dkim #E8F5E9 {
    card "Signature in header\nDNS public key\nVerifies integrity" as dkim_d
}

package "DMARC" as dmarc #FFF3E0 {
    card "DNS: v=DMARC1 p=reject\nCombines SPF+DKIM\nPolicy enforcement" as dmarc_d
}

legend bottom
SPF: Is sender IP authorized?
DKIM: Is message unmodified?
DMARC: Do they align with From?
Policy: none, quarantine, reject
endlegend
@enduml
