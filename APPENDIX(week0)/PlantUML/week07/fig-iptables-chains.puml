@startuml fig-iptables-chains
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 10
skinparam shadowing false
left to right direction
title iptables Filter Chains

card "Incoming\nPacket" as inp #FFE0B2

package "Filter Table" as filter #F5F5F5 {
    card "INPUT\n(to local process)" as input #C8E6C9
    card "FORWARD\n(through router)" as forward #BBDEFB
    card "OUTPUT\n(from local process)" as output #E1BEE7
}

card "Local\nProcess" as local #FFF9C4
card "Outgoing\nPacket" as outp #FFE0B2

inp --> input : destined\nfor host
inp --> forward : routed\nthrough
input --> local
local --> output
output --> outp
forward --> outp

legend bottom
iptables -I FORWARD 1 -p tcp --dport 9090 -j REJECT
iptables -L -n -v (list rules)
iptables -F FORWARD (flush chain)
INPUT: traffic TO this host
FORWARD: traffic THROUGH this host (router)
OUTPUT: traffic FROM this host
endlegend
@enduml
