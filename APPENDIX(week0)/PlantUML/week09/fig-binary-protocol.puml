@startuml fig-binary-protocol
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 10
skinparam shadowing false
left to right direction
title Binary Protocol Message Structure

card "Magic\n2B\n0xCAFE" as magic #E1BEE7
card "Version\n1B" as ver #BBDEFB
card "Type\n1B" as type #BBDEFB
card "Length\n4B" as len #C8E6C9
card "Payload\nvariable" as pay #FFF9C4
card "Checksum\n2B" as csum #FFCDD2

magic -r[hidden]-> ver
ver -r[hidden]-> type
type -r[hidden]-> len
len -r[hidden]-> pay
pay -r[hidden]-> csum

legend bottom
Magic: protocol identifier, sync
Length: network byte order (big-endian)
struct.pack('!HBBI', magic, ver, type, len)
struct.unpack('!HBBI', header)
endlegend
@enduml
