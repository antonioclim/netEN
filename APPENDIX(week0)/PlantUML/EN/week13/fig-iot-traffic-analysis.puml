@startuml fig-iot-traffic-analysis
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam shadowing false
title IoT Traffic Analysis

start
:Capture traffic\ntcpdump -i eth0 -w iot.pcap;
:Identify devices\nnmap -sn 192.168.1.0/24;
:Protocol stats\ntshark -q -z io,phs;
:Endpoint map\ntshark -q -z endpoints,ip;
if (Anomaly?) then (yes)
    #FFCDD2:Flag for review;
else (no)
    #C8E6C9:Normal traffic;
endif
:MQTT analysis\ntshark -Y mqtt -e mqtt.topic;
:Generate report;
stop
@enduml
