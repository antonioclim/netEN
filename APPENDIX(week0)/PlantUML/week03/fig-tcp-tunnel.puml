@startuml fig-tcp-tunnel
'A4 Portrait - Sequence diagram
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam shadowing false

skinparam sequence {
    ArrowThickness 2
    ArrowColor #1565C0
    LifeLineBorderColor #1565C0
    LifeLineBackgroundColor #E3F2FD
    ParticipantBorderColor #1565C0
    ParticipantBackgroundColor #BBDEFB
}

title TCP Tunnel (Port Forwarding)\nBridging connectivity between networks

box "Subnet A\n192.168.1.0/24" #E8F5E9
    participant "Client\n192.168.1.10" as client
    participant "Tunnel In\n192.168.1.100\n:8080" as tin
end box

box "Forwarder" #FFF3E0
    participant "Relay\nProcess" as fwd
end box

box "Subnet B\n10.0.0.0/24" #E3F2FD
    participant "Tunnel Out\n10.0.0.100" as tout
    participant "Target\n10.0.0.50\n:80" as server
end box

== Connection Setup ==

client -> tin : TCP Connect :8080
tin -> fwd : accept()
fwd -> tout : TCP Connect
tout -> server : TCP Connect :80

note over fwd
    Tunnel binds two connections
    Reads from one, writes to other
end note

== Data Transfer (Transparent) ==

client -> tin : HTTP GET /
tin -> fwd : recv()
fwd -> tout : send()
tout -> server : HTTP GET /

server --> tout : HTTP 200 OK
tout --> fwd : recv()
fwd --> tin : send()
tin --> client : HTTP 200 OK

== Perspective ==

note over client, server
    Client sees: 192.168.1.100:8080
    Server sees: 10.0.0.100 (not real client)
    
    Use Cases:
    * Bypass firewall restrictions
    * Access private networks
    * SSH: ssh -L 8080:target:80 gateway
end note

@enduml
