@startuml fig-packet-capture-workflow
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam shadowing false
title Packet Capture and Analysis Workflow

start
:Start capture\ntcpdump -i any -w demo.pcap;
:Generate traffic\nTCP client/server, UDP sender;
:Stop capture\nCtrl+C;
:Analyze with tshark\ntshark -r demo.pcap;
:Filter specific traffic\ntshark -Y "tcp.port==9090";
:Extract fields\ntshark -T fields\n-e ip.src -e tcp.flags;
:Generate statistics\ntshark -q -z conv,tcp;
:Document evidence\nSave pcap + logs;
stop

legend right
tcpdump flags:
-i any : all interfaces
-nn : no DNS resolution
-w file : write to pcap
-U : unbuffered output

tshark filters:
-Y : display filter
-T fields : output format
-q -z : statistics mode
endlegend
@enduml
