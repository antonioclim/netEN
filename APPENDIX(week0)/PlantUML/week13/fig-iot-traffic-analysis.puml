@startuml fig-iot-traffic-analysis
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam shadowing false

title IoT Traffic Analysis

start

:Start capture
tcpdump -i eth0 -w iot.pcap;

:Identify devices
nmap -sn 192.168.1.0/24;

:Protocol stats
tshark -r iot.pcap -q -z io,phs;

:Endpoint mapping
tshark -q -z endpoints,ip;

if (Anomaly?) then (yes)
    #FFCDD2:Flag for review;
else (no)
    #C8E6C9:Normal traffic;
endif

:MQTT analysis
tshark -Y mqtt -e mqtt.topic;

:Generate report;

stop

@enduml
