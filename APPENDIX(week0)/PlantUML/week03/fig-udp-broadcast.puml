@startuml fig-udp-broadcast
'A4 Landscape - Network diagram
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam shadowing false
skinparam roundCorner 5

title UDP Broadcast Communication\nOne-to-all within broadcast domain

rectangle "Layer 2 Broadcast Domain\n192.168.1.0/24" as domain #F5F5F5 {
    
    node "Switch" as sw #90CAF9
    
    rectangle "Sender\n192.168.1.10" as sender #FFE0B2
    
    rectangle "Receiver 1\n192.168.1.20" as r1 #C8E6C9
    rectangle "Receiver 2\n192.168.1.30" as r2 #C8E6C9
    rectangle "Receiver 3\n192.168.1.40" as r3 #C8E6C9
    
    node "Router\n(Boundary)" as router #FFCDD2
    
    sender -- sw
    r1 -- sw
    r2 -- sw
    r3 -- sw
    sw -- router
}

sender .[#FF9800,thickness=2].> r1 : broadcast
sender .[#FF9800,thickness=2].> r2 : broadcast
sender .[#FF9800,thickness=2].> r3 : broadcast

note right of sender
    Sender Code:
    sock = socket(AF_INET, SOCK_DGRAM)
    sock.setsockopt(SOL_SOCKET,
                    SO_BROADCAST, 1)
    sock.sendto(data,
        ('255.255.255.255', 9999))
end note

note right of r1
    Receiver Code:
    sock = socket(AF_INET, SOCK_DGRAM)
    sock.setsockopt(SOL_SOCKET,
                    SO_REUSEADDR, 1)
    sock.bind(('', 9999))
    data, addr = sock.recvfrom(1024)
end note

note bottom of router #FFCDD2
    Broadcast does NOT cross routers
end note

note as N1
    Broadcast Addresses:
    * 255.255.255.255 - Limited (local only)
    * 192.168.1.255 - Directed (/24 network)
    
    Use Cases: Service discovery, DHCP, ARP
end note

@enduml
