@startuml fig-https-tls
!theme plain
skinparam backgroundColor #FAFAFA
skinparam defaultFontName Arial
skinparam titleFontSize 18
skinparam sequenceArrowThickness 2
skinparam sequenceLifeLineBorderColor #1E3A5F
skinparam sequenceParticipantBorderColor #1E3A5F
skinparam sequenceParticipantBackgroundColor #E3F2FD

title HTTPS = HTTP + TLS Handshake

participant "Client\n(Browser)" as C
participant "Server\n(HTTPS)" as S

== TCP Handshake (1 RTT) ==

C -> S: SYN
S -> C: SYN-ACK
C -> S: ACK

note right of S: TCP connection established

== TLS Handshake (1-2 RTT) ==

C -> S: ClientHello
note left of C
  • Supported TLS versions
  • Cipher suites
  • Random bytes
  • Extensions (SNI, ALPN)
end note

S -> C: ServerHello + Certificate + ServerHelloDone
note right of S
  • Chosen TLS version
  • Selected cipher suite
  • X.509 Certificate
  • Server random
end note

C -> S: ClientKeyExchange + ChangeCipherSpec + Finished
note left of C
  • Encrypted pre-master secret
  • Switch to encrypted communication
  • Handshake verification
end note

S -> C: ChangeCipherSpec + Finished
note right of S
  • Server confirms
  • Session key derived
end note

note over C,S #E8F5E9
  **TLS Connection Established**
  All data is now encrypted end-to-end
end note

== HTTP Request/Response (1+ RTT) ==

C -> S: **GET /api/users HTTP/1.1** (encrypted)
S -> C: **HTTP/1.1 200 OK + JSON body** (encrypted)

note over C,S
  **Total latency first request: 3-4 RTT**
  For RTT = 50ms → ~150-200ms
end note

@enduml
