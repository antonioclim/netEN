services:
  week4-demo:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    container_name: week4_demo
    working_dir: /app
    # Run as host user to preserve file ownership
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - ../artifacts:/app/artifacts
    ports:
      - "5400:5400"
      - "5401:5401"
      - "5402:5402/udp"
    command: ["bash","-lc","./scripts/run_all.sh --quick && ./tests/smoke_test.sh --quick"]
