@startuml fig-smtp-session
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam shadowing false
title SMTP Session Flow

participant "Client" as C
participant "Server :587" as S

C -> S : TCP Connect
S --> C : 220 ESMTP Ready
C -> S : EHLO client.domain
S --> C : 250 Hello, STARTTLS, AUTH
C -> S : STARTTLS
S --> C : 220 Ready for TLS
C -> S : AUTH LOGIN (base64)
S --> C : 235 Authenticated
C -> S : MAIL FROM:<alice@example.com>
S --> C : 250 OK
C -> S : RCPT TO:<bob@example.com>
S --> C : 250 OK
C -> S : DATA
S --> C : 354 Start input
C -> S : Subject: Test\n\nHello!\n.
S --> C : 250 Message accepted
C -> S : QUIT
S --> C : 221 Bye
@enduml
