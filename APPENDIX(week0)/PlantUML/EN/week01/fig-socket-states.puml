@startuml fig-socket-states
skinparam backgroundColor white
skinparam defaultFontName Arial
skinparam defaultFontSize 10
skinparam shadowing false
left to right direction
title TCP Socket States

card "CLOSED" as CLOSED #ECEFF1
card "LISTEN" as LISTEN #C8E6C9
card "SYN_SENT" as SYN_SENT #FFF9C4
card "SYN_RCVD" as SYN_RCVD #FFF9C4
card "ESTABLISHED" as ESTAB #81C784
card "FIN_WAIT_1" as FW1 #FFE0B2
card "FIN_WAIT_2" as FW2 #FFE0B2
card "CLOSE_WAIT" as CW #FFCDD2
card "LAST_ACK" as LA #FFCDD2
card "TIME_WAIT" as TW #E1BEE7

CLOSED --> LISTEN : listen()
CLOSED --> SYN_SENT : connect()
LISTEN --> SYN_RCVD : rcv SYN
SYN_SENT --> ESTAB : rcv SYN-ACK
SYN_RCVD --> ESTAB : rcv ACK
ESTAB --> FW1 : close()
ESTAB --> CW : rcv FIN
FW1 --> FW2 : rcv ACK
FW2 --> TW : rcv FIN
CW --> LA : close()
LA --> CLOSED : rcv ACK
TW --> CLOSED : timeout

legend bottom
ss -tlnp : show LISTEN
ss -tnp : show ESTABLISHED
TIME_WAIT: 60-120 sec
endlegend
@enduml
